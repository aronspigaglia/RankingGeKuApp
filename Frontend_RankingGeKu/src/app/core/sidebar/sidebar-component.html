<aside class="app-sidebar d-flex flex-column">
  <!-- hidden file input -->
  <input #fileInput type="file" accept=".csv,text/csv" (change)="onFileChange($event)" class="d-none" />

  <!-- 1: CSV importieren -->
  <div class="mb-4">
    <button class="btn btn-primary w-100"
            (click)="triggerFileDialog()"
            [disabled]="busyNotesheets || busyRanking || busyExport || busyImport">
      <i class="bi bi-upload"></i> CSV importieren
    </button>

    @if (imported) {
      <small class="text-success d-block mt-2">
        <i class="bi bi-check-circle"></i> CSV erfolgreich importiert
      </small>
    } @else {
      <small class="text-danger d-block mt-2">
        <i class="bi bi-x-circle"></i> CSV noch nicht importiert
      </small>
    }
  </div>

  <!-- 2: Notenblätter erzeugen -->
  <div class="mb-3">
    <button class="btn btn-outline-primary w-100"
            (click)="generateNotesheets()"
            [disabled]="!imported || busyNotesheets || busyRanking || busyExport || busyImport">
      @if (busyNotesheets) {
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
      }
      <i class="bi bi-file-earmark-pdf"></i> Notenblätter erzeugen
    </button>
  </div>
  <!-- 3.1 Kategorie-Auswahl für Rangliste -->
  <div class="mb-3">
    <label class="form-label small mb-1">Kategorie für Rangliste</label>
    <select class="form-select form-select-sm"
            [(ngModel)]="selectedCategory"
            [disabled]="!imported || categories.length === 0 || busyNotesheets || busyRanking || busyExport || busyImport">
      <option [ngValue]="null" disabled>– Kategorie wählen –</option>
      @for (cat of categories; track cat) {
        <option [ngValue]="cat">{{ cat }}</option>
      }
    </select>
  </div>
  <!-- 3: Rangliste erzeugen -->
  <div class="mb-3">
    <button class="btn btn-warning w-100"
            (click)="generateRanking()"
            [disabled]="!imported || busyNotesheets || busyRanking || busyExport || busyImport">
      @if (busyRanking) {
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
      }
      <i class="bi bi-trophy"></i> Rangliste erzeugen
    </button>
  </div>

  <!-- Fehlertext -->
  @if (errorMsg) {
    <small class="text-danger d-block mb-3">
      {{ errorMsg }}
    </small>
  }

  <div class="mt-auto">
  <!-- Export note -->
  <div class="mt-2">
    <button class="btn btn-outline-primary w-100"
            (click)="exportData()"
            [disabled]="busyNotesheets || busyRanking || !imported || busyExport || busyImport">
      <i class="bi"></i> Export Noten
    </button>
  </div>

  <!-- Import note -->
  <div class="mt-3">
    <input #importFileInput type="file" accept=".json,application/json" (change)="onImportFileChange($event)" class="d-none" />
    <button class="btn btn-outline-primary w-100"
            (click)="importData()"
            [disabled]="busyNotesheets || busyRanking || busyExport || busyImport">
      <i class="bi"></i> Import Noten
    </button>
  </div>

  <!-- 4: Alles löschen -->
     <div class="mt-3">
    <button class="btn btn-outline-danger w-100"
            (click)="onClearClick()"
            [disabled]="busyNotesheets || busyRanking || !imported || busyExport || busyImport">
      <i class="bi bi-trash3"></i> Alles löschen
    </button>
     </div>
  </div>
</aside>
